import{c as j,e as N,u as v,A as m,f as u,j as e}from"./index-Cyvq--sK.js";import{z as i,u as w,a as k,b as S,t as C}from"./use-exa-mutation-C1KOKF2p.js";import"./utils-km2FGkQ4.js";const M=i.object({name:i.string().min(1,"Module name is required"),credits:i.string().min(1,"Credits are required").refine(t=>!isNaN(Number(t)),"Must be a valid number").refine(t=>Number(t)>0,"Must be greater than 0"),studies:i.array(i.object({value:i.string().min(1,"Study program is required")})).min(1,"At least one study program is required"),description:i.string().min(1,"Description is required")}),z=j("/exa/ui/modules/new")({component:A});function A(){const t=N(),{state:l}=v(),n=new URLSearchParams(window.location.search).get("courseId"),{mutate:g,isPending:d}=w({endpoint:"http://localhost:8080/exa/modules",redirectTo:`/exa/ui/courses/${n}`}),{register:o,control:x,handleSubmit:p,formState:{errors:s,isSubmitting:c}}=k({resolver:C(M),defaultValues:{credits:"5",studies:[{value:""}]}}),{fields:h,append:b,remove:f}=S({control:x,name:"studies"});if(l!==m.Admin&&l!==m.Lecturer)return t({to:"/exa/ui/courses"}),null;if(!n)return u.error("No course selected"),t({to:"/exa/ui/courses"}),null;const y=async a=>{try{g({course:n,credits:a.credits,name:a.name,studies:a.studies.map(r=>r.value).join(","),description:a.description})}catch(r){console.error("Error creating module:",r),u.error("Error creating module")}};return e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Add Module Description"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Fill in the details below to add a module description to the course."})]}),e.jsxs("form",{onSubmit:p(y),className:"bg-white shadow-sm ring-1 ring-gray-900/5 sm:rounded-xl",children:[e.jsx("div",{className:"px-4 py-6 sm:p-8",children:e.jsxs("div",{className:"grid max-w-2xl grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:[e.jsxs("div",{className:"col-span-full",children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium leading-6 text-gray-900",children:"Module Name"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("input",{type:"text",id:"name",...o("name"),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6"}),s.name&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:s.name.message})]})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"credits",className:"block text-sm font-medium leading-6 text-gray-900",children:"Credits"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("input",{type:"number",id:"credits",min:"1",...o("credits"),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6"}),s.credits&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:s.credits.message})]})]}),e.jsxs("div",{className:"col-span-full",children:[e.jsx("label",{className:"block text-sm font-medium leading-6 text-gray-900",children:"Study Programs"}),e.jsxs("div",{className:"mt-2 space-y-4",children:[h.map((a,r)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",...o(`studies.${r}.value`),placeholder:"e.g., Computer Science",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6"}),r>0&&e.jsx("button",{type:"button",onClick:()=>f(r),className:"inline-flex items-center p-1 border border-transparent rounded-full shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},a.id)),s.studies&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:s.studies.message}),e.jsx("button",{type:"button",onClick:()=>b({value:""}),className:"mt-2 inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Add Study Program"})]})]}),e.jsxs("div",{className:"col-span-full",children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium leading-6 text-gray-900",children:"Description"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("textarea",{id:"description",rows:4,...o("description"),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6"}),s.description&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:s.description.message})]})]})]})}),e.jsxs("div",{className:"flex items-center justify-end gap-x-4 border-t border-gray-900/10 px-4 py-4 sm:px-8",children:[e.jsx("button",{type:"button",onClick:()=>t({to:`/exa/ui/courses/${n}`}),className:"rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c||d,className:"rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:c||d?"Creating...":"Create Module"})]})]})]})}export{z as Route};
