import{c as j,e as N,u as v,A as d,j as e,d as w,p as S,f as F}from"./index-Cyvq--sK.js";import{z as a,u as k,a as C,t as L}from"./use-exa-mutation-C1KOKF2p.js";import{u as q}from"./use-lecturers-C3oeqtfI.js";import{u as M}from"./use-semesters-Ppew5eZx.js";import"./utils-km2FGkQ4.js";import"./useQuery-DjxuXhbp.js";const z=a.object({name:a.string().min(1,"Course name is required"),faculty:a.string().min(1,"Faculty is required"),maxStudents:a.string().min(1,"Maximum number of students is required").refine(r=>!isNaN(Number(r)),"Must be a valid number").refine(r=>Number(r)>0,"Must be greater than 0"),semester:a.string().min(1,"Semester is required"),lecturer:a.string().min(1,"Lecturer is required")}),V=j("/exa/ui/courses/new")({component:A});function A(){const r=N(),{state:n}=v(),{data:l,isLoading:u}=M(),{data:m,isLoading:x}=q(),{mutate:g,isPending:o}=k({endpoint:"http://localhost:8080/exa/courses",redirectTo:"/exa/ui/courses"}),{register:i,handleSubmit:h,formState:{errors:t,isSubmitting:c}}=C({resolver:L(z),defaultValues:{maxStudents:"30"}});if(n!==d.Admin&&n!==d.Lecturer)return r({to:"/exa/ui/courses"}),null;if(u||x)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});if(!l||!m)return e.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-600 rounded-lg",children:"Failed to load required data"});const b=w(l),f=S(m),p=async s=>{try{g({name:s.name,faculty:s.faculty,max_students:s.maxStudents,semester:s.semester,lecturer:s.lecturer})}catch(y){console.error("Error creating course:",y),F.error("Error creating course")}};return e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Create New Course"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Fill in the details below to create a new course."})]}),e.jsxs("form",{onSubmit:h(p),className:"bg-white shadow-sm ring-1 ring-gray-900/5 sm:rounded-xl",children:[e.jsx("div",{className:"px-4 py-6 sm:p-8",children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium leading-6 text-gray-900",children:"Course Name"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("input",{type:"text",id:"name",...i("name"),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6"}),t.name&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.name.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"faculty",className:"block text-sm font-medium leading-6 text-gray-900",children:"Faculty"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("input",{type:"text",id:"faculty",...i("faculty"),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6"}),t.faculty&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.faculty.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"maxStudents",className:"block text-sm font-medium leading-6 text-gray-900",children:"Maximum Students"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("input",{type:"number",id:"maxStudents",min:"1",...i("maxStudents"),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6"}),t.maxStudents&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.maxStudents.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lecturer",className:"block text-sm font-medium leading-6 text-gray-900",children:"Lecturer"}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("select",{id:"lecturer",...i("lecturer"),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6",children:[e.jsx("option",{value:"",children:"Select a lecturer"}),f.map(s=>e.jsxs("option",{value:s.id??"",children:[s.firstname," ",s.name," (",s.faculty||"No Faculty",")"]},s.id??""))]}),t.lecturer&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.lecturer.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"semester",className:"block text-sm font-medium leading-6 text-gray-900",children:"Semester"}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("select",{id:"semester",...i("semester"),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6",children:[e.jsx("option",{value:"",children:"Select a semester"}),b.map(s=>e.jsx("option",{value:s.id??"",children:s.name??""},s.id??""))]}),t.semester&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.semester.message})]})]})]})}),e.jsxs("div",{className:"flex items-center justify-end gap-x-4 border-t border-gray-900/10 px-4 py-4 sm:px-8",children:[e.jsx("button",{type:"button",onClick:()=>r({to:"/exa/ui/courses"}),className:"rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c||o,className:"rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:c||o?"Creating...":"Create Course"})]})]})]})}export{V as Route};
